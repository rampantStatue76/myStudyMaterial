## åŸºæœ¬æ¦‚å¿µ
Vuex æ˜¯ Vue å…¨å±€çŠ¶æ€ç®¡ç†åº“ï¼Œç”¨æ¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€ã€‚
å®ƒç±»ä¼¼ä¸€ä¸ªé›†ä¸­å¼å­˜å‚¨ï¼ˆStoreï¼‰ï¼ŒæŠŠæ‰€æœ‰ç»„ä»¶çš„å…±äº«æ•°æ®æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ç»Ÿä¸€ç®¡ç†ã€‚
Vuex é€šè¿‡ stateã€mutationsã€actionsã€gettersã€modules äº”ä¸ªæ ¸å¿ƒæ¦‚å¿µæ¥å®ç°æ•°æ®çš„æœ‰åºæµåŠ¨ã€‚é€šå¸¸æˆ‘ä»¬ä¼šåœ¨ Vue ç»„ä»¶ä¸­é€šè¿‡ this.$store.state è¯»å–çŠ¶æ€ï¼ˆåœ¨vue3ä¸­ä½¿ç”¨const store = useStore() ä¹‹åä½¿ç”¨store.stateã€store.getterã€store.actionã€store.mutationsï¼‰ï¼Œé€šè¿‡ commit æˆ– dispatch ä¿®æ”¹çŠ¶æ€ï¼Œä¿è¯æ•°æ®çš„å¯ç»´æŠ¤æ€§ä¸å¯è¿½è¸ªæ€§ã€‚

## vuexæœ‰å“ªäº›å±æ€§
- stateï¼šå…¨å±€å…±äº«å±æ€§
    é€šè¿‡this.$store.state.valueå»è¯»å–å’Œä¿®æ”¹
    é€šè¿‡mapStateå»è®¿é—®ï¼ˆä¸èƒ½ä¿®æ”¹ï¼‰
- mutations: åŒæ­¥ä¿®æ”¹
- getters: é’ˆå¯¹stateæ•°æ®è¿›è¡ŒäºŒæ¬¡è®¡ç®—
    é€šè¿‡this.$store.getters.changeStateåªèƒ½è®¿é—®ä¸èƒ½ä¿®æ”¹
- modulesï¼šå†æ¬¡ç»†åˆ†storeçš„æ¨¡å—ï¼Œåœ¨ä¸åŒæ¨¡å—ä¸­å­˜å‚¨ä¸åŒçš„åŠŸèƒ½æ•°æ®
- actions: å­˜æ”¾å…¨å±€æ–¹æ³•ï¼Œå­˜æ”¾å¼‚æ­¥ä»»åŠ¡<mutationsæ˜¯ç”¨æ¥ä¿®æ”¹stateçš„å€¼çš„ï¼Œè€Œactionsæ˜¯ç”¨æ¥æäº¤mutationsçš„>
- mutationsï¼šå­˜æ”¾å…¨å±€æ–¹æ³•ï¼Œå­˜æ”¾åŒæ­¥ä»»åŠ¡

## vuexçš„æŒä¹…åŒ–å­˜å‚¨
vuexæœ¬èº«ä¸æ˜¯æŒä¹…åŒ–å­˜å‚¨çš„ã€‚
éœ€è¦è‡ªå·±å»ä¸‹è½½æ’ä»¶æ¥è‡ªå·±é…ç½®pluginæˆ–è€…è‡ªå·±å»å­˜åˆ°localStorageä¸­

```vue
import { createStore } from 'vuex'

const store = createStore({
  // --- çŠ¶æ€ï¼ˆstateï¼‰ ---
  state() {
    return {
      count: 0,
      user: { name: 'ç§¦æ™´', age: 20 }
    }
  },

  // --- åŒæ­¥ä¿®æ”¹ï¼ˆmutationsï¼‰ ---
  mutations: {
    increment(state) {
      state.count++
    },
    decrement(state) {
      state.count--
    },
    updateUser(state, payload) {
      state.user = { ...state.user, ...payload }
    }
  },

  // --- å¼‚æ­¥æ“ä½œï¼ˆactionsï¼‰ ---
  actions: {
    asyncIncrement({ commit }) {
      setTimeout(() => {
        commit('increment')
      }, 1000)
    },
    asyncUpdateUser({ commit }, payload) {
      return new Promise(resolve => {
        setTimeout(() => {
          commit('updateUser', payload)
          resolve()
        }, 1000)
      })
    }
  },

  // --- æ´¾ç”Ÿå±æ€§ï¼ˆgettersï¼‰ ---
  getters: {
    doubleCount(state) {
      return state.count * 2
    },
    userInfo(state) {
      return `${state.user.name} (${state.user.age})`
    }
  }
})

// --- è®¢é˜…çŠ¶æ€å˜åŒ–ï¼ˆsubscribeï¼‰ ---
store.subscribe((mutation, state) => {
  console.log('ğŸ”” Mutation è§¦å‘:', mutation.type)
  console.log('ğŸ“¦ å½“å‰ state:', state)
})

// --- replaceState: æ›¿æ¢æ•´ä¸ªçŠ¶æ€ ---
store.replaceState({
  count: 10,
  user: { name: 'åˆå§‹åŒ–ç”¨æˆ·', age: 99 }
})

export default store
```

```vue
<template>
  <div class="app">
    <h1>Vue 3 + Vuex 4 å®Œæ•´åŠŸèƒ½ç¤ºä¾‹</h1>

    <p>countï¼š{{ count }}</p>
    <p>doubleCountï¼ˆgetterï¼‰ï¼š{{ doubleCount }}</p>
    <p>ç”¨æˆ·ä¿¡æ¯ï¼š{{ userInfo }}</p>

    <button @click="increment">+1</button>
    <button @click="decrement">-1</button>
    <button @click="asyncAdd">å¼‚æ­¥ +1</button>
    <button @click="updateUserInfo">å¼‚æ­¥ä¿®æ”¹ç”¨æˆ·</button>
  </div>
</template>

```
<script setup>
import { computed } from 'vue'
import { useStore } from 'vuex'

const store = useStore()

// --- state ---
const count = computed(() => store.state.count)

// --- getters ---
const doubleCount = computed(() => store.getters.doubleCount)
const userInfo = computed(() => store.getters.userInfo)

// --- mutations ---
const increment = () => store.commit('increment')
const decrement = () => store.commit('decrement')

// --- actions ---
const asyncAdd = () => store.dispatch('asyncIncrement')
const updateUserInfo = async () => {
  await store.dispatch('asyncUpdateUser', { name: 'å°æ', age: 25 })
}
</script>
```